const musicKit = require("@jasonfleischer/music-model-kit");
const PianoView = require("./lib/piano_view.js");
const log = require("@jasonfleischer/log")

const piano = { };

piano.buildView = function(options) {

	let id = options.id;
	if (id === undefined){
		log.e('id not provided for piano')
		return
	}

	let pianoView = document.getElementById(id);
	if (pianoView === undefined){
		log.e('not piano exists with id: ' + id)
		return
	}

	let range = musicKit.piano_range;
	if (options.range !== undefined){
		if (options.range.min !== undefined && options.range.max !== undefined) {
			if(isInt(options.range.min)){
				range.min = Math.min(Math.max(range.min, options.range.min), range.max);
			}
			if(isInt(options.range.max)){
				range.max = Math.min(Math.max(range.min, options.range.max), range.max);
			}
		}
	}

	let width = 1000;
	if (options.width !== undefined){
		width = options.width
	}

	let interactive = false;
	if (options.interactive !== undefined){
		interactive = options.interactive;
	}

	

	let view = new PianoView(id, width, range, interactive);
	return view;
}

function isInt(value) {
  var x = parseFloat(value);
  return !isNaN(value) && (x | 0) === x;
}

module.exports = piano;


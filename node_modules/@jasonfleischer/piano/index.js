const musicKit = require("@jasonfleischer/music-model-kit");
const PianoView = require("./lib/piano_view.js");
const log = require("@jasonfleischer/log")


class PianoBuilder {

	constructor(options) {

		let id = options.id;
		if (id === undefined){
			log.e('id not provided for piano')
			return
		}

		let pianoView = document.getElementById(id);
		if (pianoView === undefined){
			log.e('not piano exists with id: ' + id)
			return
		}

		function isInt(value) {
			var x = parseFloat(value);
			return !isNaN(value) && (x | 0) === x;
		}
		var range = musicKit.piano_range;
		if (options.range !== undefined){
			if (options.range.min !== undefined && options.range.max !== undefined) {
				if(isInt(options.range.min)){
					range.min = Math.min(Math.max(range.min, options.range.min), range.max);
				}
				if(isInt(options.range.max)){
					range.max = Math.min(Math.max(range.min, options.range.max), range.max);
				}
			}
		}

		let width = 1000;
		if (options.width !== undefined){
			width = options.width
		}

		let interactive = false;
		if (options.interactive !== undefined){
			interactive = options.interactive;
		}

		
		log.e("?" + range.min +' ' + range.max );   
		let view = new PianoView(id, width, range, interactive);
		return view;
	}
}


module.exports = { PianoBuilder };

